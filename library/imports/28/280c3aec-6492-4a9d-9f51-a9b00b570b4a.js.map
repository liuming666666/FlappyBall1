{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\Game.js"],"names":["Status","cc","Enum","Menu","Run","Over","rimPosition","simple","x","y","r","commonly","difficulty","Class","extends","Component","properties","gameOverPref","Prefab","scoreLabel","Label","ball","RigidBody","topRim","bottomRim","rimSpeed","rims","isHollow","hollowNum","qiu","ParticleSystem","hollowLabel","Node","startTimer","displayScore","playBtn","mask","background","nextRim","startAudio","AudioClip","goalAudio","hollowAudio","touchAudio","statics","onLoad","setLocalZOrder","ballInit","node","getPosition","init","getComponent","linearVelocity","self","rimPositionArr","status","score","GameOverPool","NodePool","topRimPool","bottomRimPool","key","forEach","value","index","push","stopSystem","startGame","audioEngine","play","count","topRimNode","destroy","bottomRimNode","string","setPosition","i","spawnRim","active","on","EventType","TOUCH_START","ballControll","type","getScore","resetSystem","children","color","a","b","g","totalParticles","runAction","sequence","fadeTo","callFunc","opacity","gameOver","gameOverNode","get","off","playBtnClick","position","length","instantiate","addComponent","setRotation","addChild","rim","removeRim","splice","removeComponent","spawn","scaleBy","fadeOut","update","dt","width"],"mappings":";;;;;;AAAA;;;;;AAKA,IAAIA,SAASC,GAAGC,IAAH,CAAQ;AACjBC,UAAM,CAAC,CADU;AAEjBC,SAAK,CAAC,CAFW;AAGjBC,UAAM,CAAC;AAHU,CAAR,CAAb;;AAMA;AACA,IAAIC,cAAc;AACdC,YAAO,CAAC,EAACC,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,CAAd,EAAD,EAAkB,EAACF,GAAE,CAAH,EAAKC,GAAE,GAAP,EAAWC,GAAE,CAAb,EAAlB,EAAkC,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAP,EAASC,GAAE,CAAX,EAAlC,EAAgD,EAACF,GAAE,CAAH,EAAKC,GAAE,GAAP,EAAWC,GAAE,CAAb,EAAhD,EAAgE,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,CAAd,EAAhE,CADO,EAC+E;AACzFC,cAAS,CAAC,EAACH,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,CAAC,EAAf,EAAD,EAAoB,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAP,EAASC,GAAE,EAAX,EAApB,EAAmC,EAACF,GAAE,CAAH,EAAKC,GAAE,GAAP,EAAWC,GAAE,CAAC,EAAd,EAAnC,EAAqD,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,EAAd,EAArD,EAAuE,EAACF,GAAE,CAAH,EAAKC,GAAE,GAAP,EAAWC,GAAE,CAAb,EAAvE,CAFC,EAE2F;AACrGE,gBAAY,CAAC,EAACJ,GAAE,CAAH,EAAKC,GAAE,CAAP,EAASC,GAAE,EAAX,EAAD,EAAgB,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,EAAd,EAAhB,EAAkC,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,CAAC,EAAf,EAAlC,EAAqD,EAACF,GAAE,CAAH,EAAKC,GAAE,GAAP,EAAWC,GAAE,CAAb,EAArD,EAAqE,EAACF,GAAE,CAAH,EAAKC,GAAE,CAAC,GAAR,EAAYC,GAAE,CAAC,EAAf,EAArE,CAHF,CAG4F;AAH5F,CAAlB;;AAMAT,GAAGY,KAAH,CAAS;AACLC,aAASb,GAAGc,SADP;;AAGLC,gBAAY;AACR;AACAC,sBAAchB,GAAGiB,MAFT;AAGR;AACAC,oBAAYlB,GAAGmB,KAJP;AAKR;AACAC,cAAMpB,GAAGqB,SAND;AAOR;AACAC,gBAAQtB,GAAGiB,MARH;AASR;AACAM,mBAAWvB,GAAGiB,MAVN;AAWR;AACAO,kBAAU,CAZF;AAaRC,cAAM,EAbE;AAcR;AACAC,kBAAS,CAfD;AAgBR;AACAC,mBAAW,CAjBH;AAkBR;AACAC,aAAK5B,GAAG6B,cAnBA;AAoBR;AACAC,qBAAa9B,GAAG+B,IArBR;AAsBRC,oBAAYhC,GAAGmB,KAtBP;AAuBRc,sBAAcjC,GAAGmB,KAvBT;AAwBRe,iBAASlC,GAAG+B,IAxBJ;AAyBRI,cAAMnC,GAAG+B,IAzBD;AA0BRK,oBAAYpC,GAAG+B,IA1BP;AA2BRM,iBAAS,CA3BD;AA4BRC,oBAAYtC,GAAGuC,SA5BP;AA6BRC,mBAAWxC,GAAGuC,SA7BN;AA8BRE,qBAAazC,GAAGuC,SA9BR;AA+BRG,oBAAY1C,GAAGuC;AA/BP,KAHP;;AAqCLI,aAAS;AACL5C;AADK,KArCJ;;AAyCL;AACA6C,YAAQ,kBAAY;AAChB;AACA,aAAKT,IAAL,CAAUU,cAAV,CAAyB,CAAzB;AACA,aAAKX,OAAL,CAAaW,cAAb,CAA4B,CAA5B;AACA;AACA,aAAKC,QAAL,GAAgB,KAAK1B,IAAL,CAAU2B,IAAV,CAAeC,WAAf,EAAhB;AACA;AACH,KAjDI;;AAmDLC,UAAM,gBAAW;AACb,aAAK7B,IAAL,CAAU8B,YAAV,CAAuBlD,GAAGqB,SAA1B,EAAqC8B,cAArC,GAAsD,EAAC5C,GAAE,CAAH,EAAKC,GAAE,CAAP,EAAtD;AACA;;;AAGA,YAAI4C,OAAO,IAAX;AACA;AACA,aAAKC,cAAL,GAAsB,EAAtB;AACA;AACA,aAAKC,MAAL,GAAcvD,OAAOG,IAArB;AACA;AACA,aAAKqD,KAAL,GAAa,CAAb;AACA;AACA,aAAKC,YAAL,GAAoB,IAAIxD,GAAGyD,QAAP,EAApB;AACA;AACA,aAAKC,UAAL,GAAkB,IAAI1D,GAAGyD,QAAP,CAAgB,gBAAhB,CAAlB;AACA;AACA,aAAKE,aAAL,GAAqB,IAAI3D,GAAGyD,QAAP,CAAgB,mBAAhB,CAArB;AACA;AACA,aAAI,IAAIG,GAAR,IAAevD,WAAf,EAA4B;AACxBA,wBAAYuD,GAAZ,EAAiBC,OAAjB,CAAyB,UAACC,KAAD,EAAOC,KAAP,EAAiB;AACtCX,qBAAKC,cAAL,CAAoBW,IAApB,CAAyBF,KAAzB;AACH,aAFD;AAGH;AACD;AACA,aAAKlC,GAAL,CAASqC,UAAT;AACH,KA7EI;;AA+EL;;;AAGAC,eAAW,qBAAW;AAClBlE,WAAGmE,WAAH,CAAeC,IAAf,CAAoB,KAAK9B,UAAzB,EAAoC,KAApC,EAA0C,CAA1C;AACA;AACA,aAAKW,IAAL;AACA,aAAKoB,KAAL,GAAa,CAAb;AACA;AACA,aAAK5C,IAAL,CAAUoC,OAAV,CAAkB,UAACC,KAAD,EAAW;AACzBA,kBAAMQ,UAAN,CAAiBC,OAAjB;AACAT,kBAAMU,aAAN,CAAoBD,OAApB;AACH,SAHD;AAIA,aAAK9C,IAAL,GAAY,EAAZ;AACA,aAAK8B,KAAL,GAAa,CAAb;AACA,aAAKrC,UAAL,CAAgBuD,MAAhB,GAAyB,KAAKlB,KAA9B;AACA;AACA,aAAKnC,IAAL,CAAU2B,IAAV,CAAe2B,WAAf,CAA2B,KAAK5B,QAAhC;AACA;AACA,aAAI,IAAI6B,IAAE,CAAV,EAAcA,IAAE,CAAhB,EAAmBA,GAAnB,EAAwB;AACpB,iBAAKC,QAAL,CAAc,EAACrE,GAAE,MAAI,KAAK8B,OAAL,GAAasC,CAApB,EAAsBnE,GAAE,CAAxB,EAA0BC,GAAE,CAA5B,EAAd;AACH;AACD;AACA,aAAK6C,MAAL,GAAcvD,OAAOI,GAArB;AACA;AACA,aAAKgC,IAAL,CAAU0C,MAAV,GAAmB,KAAnB;AACA;AACA,aAAK9B,IAAL,CAAU+B,EAAV,CAAa9E,GAAG+B,IAAH,CAAQgD,SAAR,CAAkBC,WAA/B,EACI,KAAK5D,IAAL,CAAU8B,YAAV,CAAuB,MAAvB,EAA+B+B,YADnC,EACgD,KAAK7D,IADrD;;AAGA;AACA,aAAKA,IAAL,CAAU8B,YAAV,CAAuBlD,GAAGqB,SAA1B,EAAqC6D,IAArC,GAA4C,CAA5C;AACH,KA/GI;;AAiHL;;;AAGAC,cAAU,oBAAW;AAAA;;AACjB,YAAG,KAAK7B,MAAL,IAAevD,OAAOI,GAAzB,EAA8B;AAC1B,gBAAG,KAAKuB,QAAL,IAAiB,CAApB,EAAuB;AACnB;AACA,qBAAKE,GAAL,CAASwD,WAAT;AACA,qBAAK3D,IAAL,CAAU,CAAV,EAAa+C,aAAb,CAA2Ba,QAA3B,CAAoC,CAApC,EAAuCnC,YAAvC,CAAoDlD,GAAG6B,cAAvD,EAAuEuD,WAAvE;AACA,qBAAKzD,SAAL;AACA,qBAAK4B,KAAL,IAAc,KAAK5B,SAAL,GAAe,CAA7B;AACA;AACA3B,mBAAGmE,WAAH,CAAeC,IAAf,CAAoB,KAAK3B,WAAzB,EAAqC,KAArC,EAA2C,CAA3C;AACA,oBAAI6C,KAAJ;AACA,wBAAQ,KAAK3D,SAAb;AACI,yBAAK,CAAL;AACK2D,gCAAQ;AACLC,+BAAG,GADE;AAELC,+BAAG,GAFE;AAGLC,+BAAG,GAHE;AAILhF,+BAAG;AAJE,yBAAR;AAMD,6BAAKgB,IAAL,CAAU,CAAV,EAAa+C,aAAb,CAA2Ba,QAA3B,CAAoC,CAApC,EAAuCnC,YAAvC,CAAoDlD,GAAG6B,cAAvD,EAAuE6D,cAAvE,GAAwF,EAAxF;AACA,6BAAK9D,GAAL,CAAS8D,cAAT,GAA0B,EAA1B;AACA;AACJ,yBAAK,CAAL;AACIJ,gCAAQ;AACJC,+BAAG,GADC;AAEJC,+BAAG,EAFC;AAGJC,+BAAG,GAHC;AAIJhF,+BAAG;AAJC,yBAAR;AAMA,6BAAKgB,IAAL,CAAU,CAAV,EAAa+C,aAAb,CAA2Ba,QAA3B,CAAoC,CAApC,EAAuCnC,YAAvC,CAAoDlD,GAAG6B,cAAvD,EAAuE6D,cAAvE,GAAwF,GAAxF;AACA,6BAAK9D,GAAL,CAAS8D,cAAT,GAA0B,GAA1B;AACA;AACJ;AACIJ,gCAAQ;AACJC,+BAAG,GADC;AAEJC,+BAAG,EAFC;AAGJC,+BAAG,EAHC;AAIJhF,+BAAG;AAJC,yBAAR;AAMA,6BAAKgB,IAAL,CAAU,CAAV,EAAa+C,aAAb,CAA2Ba,QAA3B,CAAoC,CAApC,EAAuCnC,YAAvC,CAAoDlD,GAAG6B,cAAvD,EAAuE6D,cAAvE,GAAwF,GAAxF;AACA,6BAAK9D,GAAL,CAAS8D,cAAT,GAA0B,GAA1B;AA7BR;AA+BA,qBAAK5D,WAAL,CAAiBoB,YAAjB,CAA8B,YAA9B,EAA4CD,IAA5C,CAAiD,KAAKtB,SAAtD,EAAiE2D,KAAjE;AACH,aAzCD,MAyCK;AACD,qBAAK5D,QAAL,GAAgB,CAAhB;AACA,qBAAKC,SAAL,GAAgB,CAAhB;AACA,qBAAKM,YAAL,CAAkBc,IAAlB,CAAuB8B,MAAvB,GAAgC,IAAhC;AACA;AACA7E,mBAAGmE,WAAH,CAAeC,IAAf,CAAoB,KAAK5B,SAAzB,EAAmC,KAAnC,EAAyC,CAAzC;AACA,qBAAKP,YAAL,CAAkBc,IAAlB,CAAuB4C,SAAvB,CAAiC3F,GAAG4F,QAAH,CAAY5F,GAAG6F,MAAH,CAAU,CAAV,EAAY,CAAZ,CAAZ,EAA2B7F,GAAG8F,QAAH,CAAY,YAAM;AACtE,0BAAK7D,YAAL,CAAkBc,IAAlB,CAAuBgD,OAAvB,GAAiC,GAAjC;AACA,0BAAK9D,YAAL,CAAkBc,IAAlB,CAAuB8B,MAAvB,GAAgC,KAAhC;AACP,iBAH2D,CAA3B,CAAjC;AAIH;AACD,iBAAKtB,KAAL;AACA;AACA,iBAAKrC,UAAL,CAAgBuD,MAAhB,GAAyB,KAAKlB,KAA9B;AACH;AACJ,KA9KI;;AAgLL;;;AAGAyC,cAAU,oBAAW;AACjB;AACA,aAAK1C,MAAL,GAAcvD,OAAOK,IAArB;AACA,YAAI6F,eAAe,KAAKzC,YAAL,CAAkB0C,GAAlB,EAAnB;AACA;AACA,aAAKnD,IAAL,CAAUoD,GAAV,CAAcnG,GAAG+B,IAAH,CAAQgD,SAAR,CAAkBC,WAAhC,EAA6C,KAAK5D,IAAL,CAAU8B,YAAV,CAAuB,MAAvB,EAA+B+B,YAA5E,EAAyF,KAAK7D,IAA9F;AACA,aAAKc,OAAL,CAAa2C,MAAb,GAAsB,IAAtB;AACA,aAAK1C,IAAL,CAAU0C,MAAV,GAAmB,IAAnB;AACA;;;;;;;;;;AAWH,KAtMI;;AAwML;;;AAGAuB,kBAAc,wBAAW;AACrB;AACA,aAAKlE,OAAL,CAAa2C,MAAb,GAAsB,KAAtB;AACA,aAAKX,SAAL;AACH,KA/MI;;AAiNL;;;AAGAU,cAAU,kBAASyB,QAAT,EAAmB;AACzB,aAAKhC,KAAL;AACA,YAAG,KAAKA,KAAL,IAAc,KAAKhB,cAAL,CAAoBiD,MAArC,EAA6C;AACzC,iBAAKjC,KAAL,GAAa,CAAb;AACH;AACD,YAAIC,aAAa,KAAKZ,UAAL,CAAgBwC,GAAhB,EAAjB;AACA,YAAI1B,gBAAgB,KAAKb,aAAL,CAAmBuC,GAAnB,EAApB;AACA;AACA;AACA,YAAG,CAAC5B,UAAJ,EAAgB;AACZ;AACAA,yBAAatE,GAAGuG,WAAH,CAAe,KAAKjF,MAApB,CAAb;AACAgD,uBAAWkC,YAAX,CAAwB,gBAAxB;AACAlC,uBAAWI,WAAX,CAAuB;AACnBnE,mBAAE8F,SAAS9F,CAAT,IAAc,CAAd,GAAkB,KAAKkB,IAAL,CAAU,KAAKA,IAAL,CAAU6E,MAAV,GAAiB,CAA3B,EAA8BhC,UAA9B,CAAyC/D,CAAzC,GAA2C,KAAK8B,OAAlE,GAA4EgE,SAAS9F,CADpE;AAEnBC,mBAAE6F,SAAS7F;AAFQ,aAAvB;AAIA8D,uBAAWmC,WAAX,CAAuBJ,SAAS5F,CAAhC;AACH;AACD,YAAG,CAAC+D,aAAJ,EAAmB;AACf;AACAA,4BAAgBxE,GAAGuG,WAAH,CAAe,KAAKhF,SAApB,CAAhB;AACAiD,0BAAcgC,YAAd,CAA2B,mBAA3B;AACAhC,0BAAcE,WAAd,CAA0B;AACtBnE,mBAAE8F,SAAS9F,CAAT,IAAc,CAAd,GAAkB,KAAKkB,IAAL,CAAU,KAAKA,IAAL,CAAU6E,MAAV,GAAiB,CAA3B,EAA8B9B,aAA9B,CAA4CjE,CAA5C,GAA8C,KAAK8B,OAArE,GAA+EgE,SAAS9F,CADpE;AAEtBC,mBAAE6F,SAAS7F;AAFW,aAA1B;AAIAgE,0BAAciC,WAAd,CAA0BJ,SAAS5F,CAAnC;AACH;AACD,aAAKsC,IAAL,CAAU2D,QAAV,CAAmBpC,UAAnB,EAA8B,CAA9B;AACA,aAAKvB,IAAL,CAAU2D,QAAV,CAAmBlC,aAAnB,EAAiC,CAAjC;AACA;AACA,YAAImC,MAAM;AACNrC,wBAAYA,UADN;AAENE,2BAAeA;AAFT,SAAV;AAIA,aAAK/C,IAAL,CAAUuC,IAAV,CAAe2C,GAAf;AAEH,KA1PI;;AA4PL;;;AAGAC,eAAW,mBAASrF,SAAT,EAAoB;AAAA;;AAC3B,aAAKqD,QAAL,CAAc,KAAKvB,cAAL,CAAoB,KAAKgB,KAAzB,CAAd;AACA,aAAK5C,IAAL,CAAUoC,OAAV,CAAkB,UAAC8C,GAAD,EAAK5C,KAAL,EAAe;AAC7B,gBAAG4C,IAAInC,aAAJ,IAAqBjD,UAAUwB,IAAlC,EAAwC;AACpC,uBAAKtB,IAAL,CAAUoF,MAAV,CAAiB,CAAjB,EAAmB,CAAnB;AACAF,oBAAIrC,UAAJ,CAAewC,eAAf,CAA+B9G,GAAGqB,SAAlC;AACAsF,oBAAInC,aAAJ,CAAkBa,QAAlB,CAA2B,CAA3B,EAA8BnC,YAA9B,CAA2ClD,GAAG6B,cAA9C,EAA8DoC,UAA9D;AACA0C,oBAAIrC,UAAJ,CAAeqB,SAAf,CAAyB3F,GAAG+G,KAAH,CAAS/G,GAAGgH,OAAH,CAAW,CAAX,EAAc,GAAd,CAAT,EAA4BhH,GAAGiH,OAAH,CAAW,GAAX,CAA5B,CAAzB,EAAsEjH,GAAG8F,QAAH,CAAY,YAAI;AAClFa,wBAAIrC,UAAJ,CAAeC,OAAf;AACH,iBAFqE,CAAtE;AAGAoC,oBAAInC,aAAJ,CAAkBmB,SAAlB,CAA4B3F,GAAG+G,KAAH,CAAS/G,GAAGgH,OAAH,CAAW,CAAX,EAAc,GAAd,CAAT,EAA4BhH,GAAGiH,OAAH,CAAW,GAAX,CAA5B,CAA5B,EAAyEjH,GAAG8F,QAAH,CAAY,YAAI;;AAErFa,wBAAInC,aAAJ,CAAkBD,OAAlB;AACH,iBAHwE,CAAzE;AAIA;;;;;;AAMA;AACA;AACA;AACA,uBAAO,IAAP;AACH;AACJ,SAvBD;AAwBH,KAzRI;;AA2RL;AACA2C,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,KAAK1F,IAAL,CAAU6E,MAAV,GAAkB,CAAlB,IAAuB,KAAKhD,MAAL,IAAe,CAAtC,IAA2C,KAAKlC,IAAL,CAAU2B,IAAV,CAAexC,CAAf,GAAkB,KAAKkB,IAAL,CAAU,CAAV,EAAa6C,UAAb,CAAwB/D,CAAxB,GAA4B,KAAKkB,IAAL,CAAU,CAAV,EAAa6C,UAAb,CAAwB8C,KAAxB,GAA8B,CAA1H,EAA6H;AACzH,iBAAKpB,QAAL;AACH;AACJ;;AAhSI,CAAT","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["/**\n * 挂载在canvas下面，控制游戏的主要进程逻辑\n * 得分，失败，重新开始\n */\n\nvar Status = cc.Enum({\n    Menu: -1,\n    Run: -1,\n    Over: -1\n});\n\n//随机节奏篮圈位置\nvar rimPosition = {\n    simple:[{x:0,y:-100,r:0},{x:0,y:100,r:0},{x:0,y:0,r:0},{x:0,y:200,r:0},{x:0,y:-200,r:0}],    //简单\n        commonly:[{x:0,y:-200,r:-15},{x:0,y:0,r:15},{x:0,y:200,r:-20},{x:0,y:-100,r:20},{x:0,y:100,r:0}],    //一般\n        difficulty: [{x:0,y:0,r:30},{x:0,y:-150,r:30},{x:0,y:-150,r:-30},{x:0,y:200,r:0},{x:0,y:-125,r:-20}]  //困难\n};\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //游戏结束面板预制\n        gameOverPref: cc.Prefab,\n        //得分标签\n        scoreLabel: cc.Label,\n        //篮球\n        ball: cc.RigidBody,\n        //上篮筐\n        topRim: cc.Prefab,\n        //下篮筐\n        bottomRim: cc.Prefab,\n        //篮筐移动速度\n        rimSpeed: 0,\n        rims: [],\n        //是不是空心,默认是空心\n        isHollow:0,\n        //空心次数\n        hollowNum: 0,\n        //球粒子\n        qiu: cc.ParticleSystem,\n        //空心球分数特效节点\n        hollowLabel: cc.Node,\n        startTimer: cc.Label,\n        displayScore: cc.Label,\n        playBtn: cc.Node,\n        mask: cc.Node,\n        background: cc.Node,\n        nextRim: 0,\n        startAudio: cc.AudioClip,\n        goalAudio: cc.AudioClip,\n        hollowAudio: cc.AudioClip,\n        touchAudio: cc.AudioClip\n    },\n\n    statics: {\n        Status\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        //设置轴位置\n        this.mask.setLocalZOrder(4);\n        this.playBtn.setLocalZOrder(5);\n        //记录篮球初始位置\n        this.ballInit = this.ball.node.getPosition();\n        //this.scheduleOnce(this.gameOver, 5);\n    },\n\n    init: function() {\n        this.ball.getComponent(cc.RigidBody).linearVelocity = {x:0,y:0};\n        /*console.log(this.background.getComponent(\"Scroll\").initSpeed);\n        this.background.speed = this.background.getComponent(\"Scroll\").initSpeed;\n        this.rimSpeed = this.background.getComponent(\"Scroll\").initRimSpeed;*/\n        var self = this;\n        //初始化篮筐位置数组\n        this.rimPositionArr = [];\n        //游戏状态主菜单界面\n        this.status = Status.Menu;\n        //分数初始化\n        this.score = 0;\n        //游戏结束面板池\n        this.GameOverPool = new cc.NodePool();\n        //上篮筐池\n        this.topRimPool = new cc.NodePool(\"TopPoolHandler\");\n        //下篮筐池\n        this.bottomRimPool = new cc.NodePool(\"BottomPoolHandler\");\n        //把篮球位置全装进数组\n        for(var key in rimPosition) {\n            rimPosition[key].forEach((value,index) => {\n                self.rimPositionArr.push(value);\n            });\n        }\n        //关闭球的粒子系统\n        this.qiu.stopSystem();\n    },\n\n    /**\n     * 开始游戏\n     */\n    startGame: function() {\n        cc.audioEngine.play(this.startAudio,false,1);\n        //初始化游戏参数\n        this.init();\n        this.count = 0;\n        //清除全部篮筐\n        this.rims.forEach((value) => {\n            value.topRimNode.destroy();\n            value.bottomRimNode.destroy();\n        });\n        this.rims = [];\n        this.score = 0;\n        this.scoreLabel.string = this.score;\n        //回归篮球位置\n        this.ball.node.setPosition(this.ballInit);\n        //背景开始移动，开始生成篮筐\n        for(let i=0 ; i<2; i++) {\n            this.spawnRim({x:200+this.nextRim*i,y:0,r:0});\n        }\n        //修改游戏状态\n        this.status = Status.Run;\n        //隐藏遮罩层\n        this.mask.active = false;\n        //添加球控制事件\n        this.node.on(cc.Node.EventType.TOUCH_START,\n            this.ball.getComponent(\"Ball\").ballControll,this.ball);\n\n        //把球修改成动态的\n        this.ball.getComponent(cc.RigidBody).type = 2;\n    },\n\n    /**\n     * 获得分数，并修改\n     */\n    getScore: function() {\n        if(this.status == Status.Run) {\n            if(this.isHollow == 0) {\n                //开启粒子系统\n                this.qiu.resetSystem();\n                this.rims[0].bottomRimNode.children[0].getComponent(cc.ParticleSystem).resetSystem();\n                this.hollowNum++;\n                this.score += this.hollowNum*1;\n                //播放空心得分音效\n                cc.audioEngine.play(this.hollowAudio,false,1);\n                var color;\n                switch (this.hollowNum) {\n                    case 1 :\n                         color = {\n                            a: 255,\n                            b: 235,\n                            g: 191,\n                            r: 156\n                        };\n                        this.rims[0].bottomRimNode.children[0].getComponent(cc.ParticleSystem).totalParticles = 50;\n                        this.qiu.totalParticles = 50;\n                        break;\n                    case 2 :\n                        color = {\n                            a: 255,\n                            b: 77,\n                            g: 232,\n                            r: 255\n                        };\n                        this.rims[0].bottomRimNode.children[0].getComponent(cc.ParticleSystem).totalParticles = 100;\n                        this.qiu.totalParticles = 100;\n                        break;\n                    default :\n                        color = {\n                            a: 255,\n                            b: 68,\n                            g: 63,\n                            r: 252\n                        };\n                        this.rims[0].bottomRimNode.children[0].getComponent(cc.ParticleSystem).totalParticles = 150;\n                        this.qiu.totalParticles = 150;\n                }\n                this.hollowLabel.getComponent(\"HollowAnim\").init(this.hollowNum ,color);\n            }else{\n                this.isHollow = 0;\n                this.hollowNum =0;\n                this.displayScore.node.active = true;\n                //播放普通得分音效\n                cc.audioEngine.play(this.goalAudio,false,1);\n                this.displayScore.node.runAction(cc.sequence(cc.fadeTo(1,0),cc.callFunc(() => {\n                        this.displayScore.node.opacity = 255;\n                        this.displayScore.node.active = false;\n                })));\n            }\n            this.score++;\n            //修改分数显示的值\n            this.scoreLabel.string = this.score;\n        }\n    },\n\n    /**\n     * 游戏结束\n     */\n    gameOver: function() {\n        //游戏结束，修改游戏状态\n        this.status = Status.Over;\n        var gameOverNode = this.GameOverPool.get();\n        //取消绑定时间\n        this.node.off(cc.Node.EventType.TOUCH_START, this.ball.getComponent(\"Ball\").ballControll,this.ball);\n        this.playBtn.active = true;\n        this.mask.active = true;\n        /*if(!gameOverNode) {\n            console.log(\"创建了结束面板\");\n            //制造游戏结束预制节点\n            gameOverNode = cc.instantiate(this.gameOverPref);\n\n            //把节点传给GAMEOVER\n            gameOverNode.getComponent(\"GameOver\").game = this.node;\n        }\n        gameOverNode.getComponent(\"GameOver\").scoreLabel.string = \"score:\" + this.score;\n        //把生成的GameOver节点挂到Canvas下面\n        this.node.addChild(gameOverNode,5);*/\n    },\n\n    /**\n     * play按钮点击事件\n     */\n    playBtnClick: function() {\n        //开始按钮隐藏\n        this.playBtn.active = false;\n        this.startGame();\n    },\n\n    /**\n     * 生成篮筐\n     */\n    spawnRim: function(position) {\n        this.count ++;\n        if(this.count == this.rimPositionArr.length) {\n            this.count = 0;\n        }\n        var topRimNode = this.topRimPool.get();\n        var bottomRimNode = this.bottomRimPool.get();\n        //var rimPositionArr = rimPosition.simple;   //简单数组\n        //var index = Math.floor((Math.random()*rimPositionArr.length));\n        if(!topRimNode) {\n            //上篮筐\n            topRimNode = cc.instantiate(this.topRim);\n            topRimNode.addComponent('TopPoolHandler');\n            topRimNode.setPosition({\n                x:position.x == 0 ? this.rims[this.rims.length-1].topRimNode.x+this.nextRim : position.x,\n                y:position.y\n            });\n            topRimNode.setRotation(position.r);\n        }\n        if(!bottomRimNode) {\n            //下篮筐\n            bottomRimNode = cc.instantiate(this.bottomRim);\n            bottomRimNode.addComponent('BottomPoolHandler');\n            bottomRimNode.setPosition({\n                x:position.x == 0 ? this.rims[this.rims.length-1].bottomRimNode.x+this.nextRim : position.x,\n                y:position.y\n            });\n            bottomRimNode.setRotation(position.r);\n        }\n        this.node.addChild(topRimNode,1);\n        this.node.addChild(bottomRimNode,3);\n        //默认为空心球,0为空心\n        var rim = {\n            topRimNode: topRimNode,\n            bottomRimNode: bottomRimNode\n        };\n        this.rims.push(rim);\n\n    },\n\n    /**\n     * 移除篮筐\n     */\n    removeRim: function(bottomRim) {\n        this.spawnRim(this.rimPositionArr[this.count]);\n        this.rims.forEach((rim,index) => {\n            if(rim.bottomRimNode == bottomRim.node) {\n                this.rims.splice(0,1);\n                rim.topRimNode.removeComponent(cc.RigidBody);\n                rim.bottomRimNode.children[0].getComponent(cc.ParticleSystem).stopSystem();\n                rim.topRimNode.runAction(cc.spawn(cc.scaleBy(1, 1.5),cc.fadeOut(0.5)),cc.callFunc(()=>{\n                    rim.topRimNode.destroy();\n                }));\n                rim.bottomRimNode.runAction(cc.spawn(cc.scaleBy(1, 1.5),cc.fadeOut(0.5)),cc.callFunc(()=>{\n\n                    rim.bottomRimNode.destroy();\n                }));\n                /*rim.topRimNode.runAction(cc.sequence(cc.fadeOut(0.5),cc.callFunc(()=>{\n                    rim.topRimNode.destroy();\n                })));\n                rim.bottomRimNode.runAction(cc.sequence(cc.fadeOut(0.5),cc.callFunc(()=>{\n                    rim.bottomRimNode.destroy();\n                })));*/\n                //this.topRimPool.put(value.topRimNode);\n                //this.bottomRimPool.put(value.bottomRimNode);\n                //this.rims.splice(0,1);\n                return true;\n            }\n        });\n    },\n\n    // called every frame，每一帧调用更新\n    update: function (dt) {\n        if(this.rims.length >0 && this.status == 1 && this.ball.node.x> this.rims[0].topRimNode.x + this.rims[0].topRimNode.width/2) {\n            this.gameOver();\n        }\n    }\n\n});\n"]}