{"version":3,"sources":["Scroll.js"],"names":["cc","Class","extends","Component","properties","speed","resetX","ball","RigidBody","game","Node","onLoad","initSpeed","initRimSpeed","getComponent","rimSpeed","update","dt","status","ballSpeed","linearVelocity","ballSpeedX","x","console","log","ballPositionX","ballInit","node","backgroundMove","rimMove","Math","abs","ballX","rims","forEach","rim","index","topRimNode","bottomRimNode","y"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,eAAO,CAFC;AAGR;AACAC,gBAAQ,CAJA;AAKRC,cAAMP,GAAGQ,SALD;AAMRC,cAAMT,GAAGU;AAND,KAHP;;AAYLC,YAAQ,kBAAW;AACf,aAAKC,SAAL,GAAiB,KAAKP,KAAtB,CADe,CACiB;AAChC,aAAKQ,YAAL,GAAoB,KAAKJ,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BC,QAAnD,CAFe,CAEiD;AACnE,KAfI;;AAiBLC,YAAQ,gBAASC,EAAT,EAAa;AACjB;AACA,YAAG,KAAKR,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BI,MAA/B,IAAyC,CAA5C,EAA+C;AAC3C,gBAAIC,YAAY,KAAKZ,IAAL,CAAUO,YAAV,CAAuBd,GAAGQ,SAA1B,EAAqCY,cAArD,CAD2C,CAC6B;AACxE,gBAAIC,aAAaF,UAAUG,CAA3B,CAF2C,CAEX;AAChCC,oBAAQC,GAAR,CAAYH,UAAZ;AACA,gBAAII,gBAAgB,KAAKhB,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BY,QAA/B,CAAwCJ,CAA5D,CAJ2C,CAIoB;AAC/D,iBAAKf,IAAL,CAAUoB,IAAV,CAAeL,CAAf,GAAmBG,aAAnB,CAL2C,CAKP;AACpC,iBAAKG,cAAL,CAAoBX,EAApB,EAAuBI,UAAvB,EAN2C,CAMJ;AACvC,iBAAKQ,OAAL,CAAaZ,EAAb,EAAgBI,UAAhB,EAP2C,CAOZ;AAClC;AACJ,KA5BI;;AA8BL;;;AAGAO,oBAAgB,wBAAUX,EAAV,EAAaI,UAAb,EAAyB;AACrC,YAAG,KAAKM,IAAL,CAAUL,CAAV,IAAe,KAAKhB,MAAvB,EAA+B;AAC3B,iBAAKqB,IAAL,CAAUL,CAAV,IAAe,KAAKhB,MAApB;AACH;AACD,YAAGe,cAAc,CAAjB,EAAoB;AAChB,gBAAG,KAAKhB,KAAL,GAAa,KAAKO,SAArB,EAAgC;AAC5B,qBAAKP,KAAL,IAAc,MAAIY,EAAlB;AACAM,wBAAQC,GAAR,CAAY,eAAa,KAAKnB,KAA9B;AACH;AACD,iBAAKsB,IAAL,CAAUL,CAAV,IAAe,KAAKjB,KAAL,GAAWY,EAA1B;AACH,SAND,MAMK;AACD,gBAAGa,KAAKC,GAAL,CAASV,UAAT,IAAuB,EAA1B,EAA8B;AAC1B,qBAAKhB,KAAL,GAAa,CAAb,CAD0B,CACN;AACpB;AACH;AACD,gBAAI2B,QAAQX,aAAWJ,EAAvB;AACA,gBAAG,CAAC,EAAD,GAAMI,aAAWJ,EAAjB,GAAsB,CAAzB,EAA4B;AACxBe,wBAAQ,CAAC,EAAT;AACH;AACD,iBAAKL,IAAL,CAAUL,CAAV,IAAeD,aAAWJ,EAA1B;AACH;AACJ,KAtDI;;AAwDL;;;;AAIAY,aAAS,iBAAUZ,EAAV,EAAaI,UAAb,EAAyB;AAAA;;AAC9B,YAAIN,WAAW,KAAKN,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BC,QAA9C;AACA,aAAKN,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BmB,IAA/B,CAAoCC,OAApC,CAA4C,UAACC,GAAD,EAAKC,KAAL,EAAe;AACvD,gBAAGf,cAAc,CAAjB,EAAoB;AAChB,oBAAGN,WAAW,MAAKF,YAAnB,EAAiC;AAC7B,0BAAKJ,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BC,QAA/B,IAA2C,MAAIE,EAA/C;AACH;AACDkB,oBAAIE,UAAJ,CAAef,CAAf,IAAoBP,WAASE,EAA7B;AACAkB,oBAAIG,aAAJ,CAAkBhB,CAAlB,IAAuBP,WAASE,EAAhC;AACH,aAND,MAMK;AACD;AACA,oBAAGa,KAAKC,GAAL,CAASV,UAAT,IAAuB,EAA1B,EAA8B;AAC1B,0BAAKZ,IAAL,CAAUK,YAAV,CAAuB,MAAvB,EAA+BC,QAA/B,GAAwC,CAAxC,CAD0B,CACkB;AAC5C,0BAAKR,IAAL,CAAUO,YAAV,CAAuBd,GAAGQ,SAA1B,EAAqCY,cAArC,GAAsD,EAACE,GAAE,CAAH,EAAKiB,GAAE,MAAKhC,IAAL,CAAUO,YAAV,CAAuBd,GAAGQ,SAA1B,EAAqCY,cAArC,CAAoDmB,CAA3D,EAAtD;AACH;AACD,oBAAIP,QAAQX,aAAWJ,EAAvB;AACA,oBAAG,CAAC,EAAD,GAAMI,aAAWJ,EAAjB,GAAsB,CAAzB,EAA4B;AACxBe,4BAAQ,CAAC,EAAT;AACH;AACDG,oBAAIE,UAAJ,CAAef,CAAf,IAAoBU,KAApB;AACAG,oBAAIG,aAAJ,CAAkBhB,CAAlB,IAAuBU,KAAvB;AACH;AACJ,SApBD;AAqBH;;AAnFI,CAAT","file":"Scroll.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //背景移动速度\r\n        speed: 0,\r\n        //重置的边界\r\n        resetX: 0,\r\n        ball: cc.RigidBody,\r\n        game: cc.Node\r\n    },\r\n\r\n    onLoad: function() {\r\n        this.initSpeed = this.speed;    //背景移动初始值\r\n        this.initRimSpeed = this.game.getComponent(\"Game\").rimSpeed;    //篮筐移动初始值\r\n    },\r\n\r\n    update: function(dt) {\r\n        //Run状态才移动\r\n        if(this.game.getComponent(\"Game\").status == 1) {\r\n            var ballSpeed = this.ball.getComponent(cc.RigidBody).linearVelocity;    //篮球的速度对象\r\n            var ballSpeedX = ballSpeed.x;   //篮球的x轴速度\r\n            console.log(ballSpeedX);\r\n            var ballPositionX = this.game.getComponent(\"Game\").ballInit.x; //篮球的原x位置\r\n            this.ball.node.x = ballPositionX;   //设置篮球始终在原位置\r\n            this.backgroundMove(dt,ballSpeedX);    //移动背景\r\n            this.rimMove(dt,ballSpeedX);   //移动篮框\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 背景移动\r\n     */\r\n    backgroundMove: function (dt,ballSpeedX) {\r\n        if(this.node.x <= this.resetX) {\r\n            this.node.x -= this.resetX;\r\n        }\r\n        if(ballSpeedX == 0) {\r\n            if(this.speed > this.initSpeed) {\r\n                this.speed -= 500*dt;\r\n                console.log(\"this.speed\"+this.speed);\r\n            }\r\n            this.node.x += this.speed*dt;\r\n        }else{\r\n            if(Math.abs(ballSpeedX) < 20) {\r\n                this.speed = 0;     //设置背景的速度为零\r\n                //this.ball.getComponent(cc.RigidBody).linearVelocity = {x:0,y:this.ball.getComponent(cc.RigidBody).linearVelocity.y};\r\n            }\r\n            var ballX = ballSpeedX*dt;\r\n            if(-20 < ballSpeedX*dt < 0) {\r\n                ballX = -40;\r\n            }\r\n            this.node.x -= ballSpeedX*dt;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 篮筐移动\r\n     * @param dt\r\n     */\r\n    rimMove: function (dt,ballSpeedX) {\r\n        var rimSpeed = this.game.getComponent(\"Game\").rimSpeed;\r\n        this.game.getComponent(\"Game\").rims.forEach((rim,index) => {\r\n            if(ballSpeedX == 0) {\r\n                if(rimSpeed > this.initRimSpeed) {\r\n                    this.game.getComponent(\"Game\").rimSpeed -= 500*dt;\r\n                }\r\n                rim.topRimNode.x += rimSpeed*dt;\r\n                rim.bottomRimNode.x += rimSpeed*dt;\r\n            }else{\r\n                //衰减篮球速度\r\n                if(Math.abs(ballSpeedX) < 20) {\r\n                    this.game.getComponent(\"Game\").rimSpeed=0;  //设置篮筐移动速度为零\r\n                    this.ball.getComponent(cc.RigidBody).linearVelocity = {x:0,y:this.ball.getComponent(cc.RigidBody).linearVelocity.y};\r\n                }\r\n                var ballX = ballSpeedX*dt;\r\n                if(-20 < ballSpeedX*dt < 0) {\r\n                    ballX = -40;\r\n                }\r\n                rim.topRimNode.x -= ballX;\r\n                rim.bottomRimNode.x -= ballX;\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n"]}